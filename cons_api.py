from flask import Flask, render_template, request
import requests
import json

def consulta_tribunal (numero_processo):

    tribunais = {
        "Tribunal Superior do Trabalho": "https://api-publica.datajud.cnj.jus.br/api_publica_tst/_search",
        "Tribunal Superior Eleitoral": "https://api-publica.datajud.cnj.jus.br/api_publica_tse/_search",
        "Tribunal Superior de Justiça": "https://api-publica.datajud.cnj.jus.br/api_publica_stj/_search",
        "Tribunal Superior Militar": "https://api-publica.datajud.cnj.jus.br/api_publica_stm/_search",
        "Tribunal Regional Federal da 1ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trf1/_search",
        "Tribunal Regional Federal da 2ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trf2/_search",
        "Tribunal Regional Federal da 3ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trf3/_search",
        "Tribunal Regional Federal da 4ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trf4/_search",
        "Tribunal Regional Federal da 5ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trf5/_search",
        "Tribunal Regional Federal da 6ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trf6/_search",
        "Tribunal de Justiça do Acre": "https://api-publica.datajud.cnj.jus.br/api_publica_tjac/_search",
        "Tribunal de Justiça de Alagoas": "https://api-publica.datajud.cnj.jus.br/api_publica_tjal/_search",
        "Tribunal de Justiça do Amazonas": "https://api-publica.datajud.cnj.jus.br/api_publica_tjam/_search",
        "Tribunal de Justiça do Amapá": "https://api-publica.datajud.cnj.jus.br/api_publica_tjap/_search",
        "Tribunal de Justiça da Bahia": "https://api-publica.datajud.cnj.jus.br/api_publica_tjba/_search",
        "Tribunal de Justiça do Ceará": "https://api-publica.datajud.cnj.jus.br/api_publica_tjce/_search",
        "TJ do Distrito Federal e Territórios": "https://api-publica.datajud.cnj.jus.br/api_publica_tjdft/_search",
        "Tribunal de Justiça do Espírito Santo": "https://api-publica.datajud.cnj.jus.br/api_publica_tjes/_search",
        "Tribunal de Justiça do Goiás": "https://api-publica.datajud.cnj.jus.br/api_publica_tjgo/_search",
        "Tribunal de Justiça do Maranhão": "https://api-publica.datajud.cnj.jus.br/api_publica_tjma/_search",
        "Tribunal de Justiça de Minas Gerais": "https://api-publica.datajud.cnj.jus.br/api_publica_tjmg/_search",
        "TJ do Mato Grosso de Sul": "https://api-publica.datajud.cnj.jus.br/api_publica_tjms/_search",
        "Tribunal de Justiça do Mato Grosso": "https://api-publica.datajud.cnj.jus.br/api_publica_tjmt/_search",
        "Tribunal de Justiça do Pará": "https://api-publica.datajud.cnj.jus.br/api_publica_tjpa/_search",
        "Tribunal de Justiça da Paraíba": "https://api-publica.datajud.cnj.jus.br/api_publica_tjpb/_search",
        "Tribunal de Justiça de Pernambuco": "https://api-publica.datajud.cnj.jus.br/api_publica_tjpe/_search",
        "Tribunal de Justiça do Piauí": "https://api-publica.datajud.cnj.jus.br/api_publica_tjpi/_search",
        "Tribunal de Justiça do Paraná": "https://api-publica.datajud.cnj.jus.br/api_publica_tjpr/_search",
        "Tribunal de Justiça do Rio de Janeiro": "https://api-publica.datajud.cnj.jus.br/api_publica_tjrj/_search",
        "TJ do Rio Grande do Norte": "https://api-publica.datajud.cnj.jus.br/api_publica_tjrn/_search",
        "Tribunal de Justiça de Rondônia": "https://api-publica.datajud.cnj.jus.br/api_publica_tjro/_search",
        "Tribunal de Justiça de Roraima": "https://api-publica.datajud.cnj.jus.br/api_publica_tjrr/_search",
        "Tribunal de Justiça do Rio Grande do Sul": "https://api-publica.datajud.cnj.jus.br/api_publica_tjrs/_search",
        "Tribunal de Justiça de Santa Catarina": "https://api-publica.datajud.cnj.jus.br/api_publica_tjsc/_search",
        "Tribunal de Justiça de Sergipe": "https://api-publica.datajud.cnj.jus.br/api_publica_tjse/_search",
        "Tribunal de Justiça de São Paulo": "https://api-publica.datajud.cnj.jus.br/api_publica_tjsp/_search",
        "Tribunal de Justiça do Tocantins": "https://api-publica.datajud.cnj.jus.br/api_publica_tjto/_search",
        "Tribunal Regional do Trabalho da 1ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt1/_search",
        "Tribunal Regional do Trabalho da 2ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt2/_search",
        "Tribunal Regional do Trabalho da 3ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt3/_search",
        "Tribunal Regional do Trabalho da 4ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt4/_search",
        "Tribunal Regional do Trabalho da 5ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt5/_search",
        "Tribunal Regional do Trabalho da 6ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt6/_search",
        "Tribunal Regional do Trabalho da 7ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt7/_search",
        "Tribunal Regional do Trabalho da 8ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt8/_search",
        "Tribunal Regional do Trabalho da 9ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt9/_search",
        "Tribunal Regional do Trabalho da 10ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt10/_search",
        "Tribunal Regional do Trabalho da 11ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt11/_search",
        "Tribunal Regional do Trabalho da 12ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt12/_search",
        "Tribunal Regional do Trabalho da 13ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt13/_search",
        "Tribunal Regional do Trabalho da 14ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt14/_search",
        "Tribunal Regional do Trabalho da 15ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt15/_search",
        "Tribunal Regional do Trabalho da 16ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt16/_search",
        "Tribunal Regional do Trabalho da 17ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt17/_search",
        "Tribunal Regional do Trabalho da 18ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt18/_search",
        "Tribunal Regional do Trabalho da 19ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt19/_search",
        "Tribunal Regional do Trabalho da 20ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt20/_search",
        "Tribunal Regional do Trabalho da 21ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt21/_search",
        "Tribunal Regional do Trabalho da 22ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt22/_search",
        "Tribunal Regional do Trabalho da 23ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt23/_search",
        "Tribunal Regional do Trabalho da 24ª Região": "https://api-publica.datajud.cnj.jus.br/api_publica_trt24/_search",
        "Tribunal Regional Eleitoral do Acre": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-ac/_search",
        "Tribunal Regional Eleitoral de Alagoas": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-al/_search",
        "Tribunal Regional Eleitoral do Amazonas": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-am/_search",
        "Tribunal Regional Eleitoral do Amapá": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-ap/_search",
        "Tribunal de Justiça da Bahia": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-ba/_search",
        "Tribunal Regional Eleitoral do Ceará": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-ce/_search",
        "TJ do Distrito Federal e Territórios": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-dft/_search",
        "Tribunal Regional Eleitoral do Espírito Santo": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-es/_search",
        "Tribunal Regional Eleitoral do Goiás": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-go/_search",
        "Tribunal Regional Eleitoral do Maranhão": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-ma/_search",
        "Tribunal Regional Eleitoral de Minas Gerais": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-mg/_search",
        "TJ do Mato Grosso de Sul": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-ms/_search",
        "Tribunal Regional Eleitoral do Mato Grosso": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-mt/_search",
        "Tribunal Regional Eleitoral do Pará": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-pa/_search",
        "Tribunal Regional Eleitoral da Paraíba": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-pb/_search",
        "Tribunal Regional Eleitoral de Pernambuco": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-pe/_search",
        "Tribunal Regional Eleitoral do Piauí": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-pi/_search",
        "Tribunal Regional Eleitoral do Paraná": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-pr/_search",
        "Tribunal Regional Eleitoral do Rio de Janeiro": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-rj/_search",
        "TJ do Rio Grande do Norte": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-rn/_search",
        "Tribunal Regional Eleitoral de Rondônia": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-ro/_search",
        "Tribunal Regional Eleitoral de Roraima": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-rr/_search",
        "Tribunal Regional Eleitoral do Rio Grande do Sul": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-rs/_search",
        "Tribunal Regional Eleitoral de Santa Catarina": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-sc/_search",
        "Tribunal Regional Eleitoral de Sergipe": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-se/_search",
        "Tribunal Regional Eleitoral de São Paulo": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-sp/_search",
        "Tribunal Regional Eleitoral do Tocantins": "https://api-publica.datajud.cnj.jus.br/api_publica_tre-to/_search",
        "Tribunal Justiça Militar de Minas Gerais": "https://api-publica.datajud.cnj.jus.br/api_publica_tjmmg/_search",
        "Tribunal Justiça Militar do Rio Grande do Sul": "https://api-publica.datajud.cnj.jus.br/api_publica_tjmrs/_search",
        "Tribunal Justiça Militar de São Paulo": "https://api-publica.datajud.cnj.jus.br/api_publica_tjmsp/_search"
    }

    chavepublica = 'cDZHYzlZa0JadVREZDJCendQbXY6SkJlTzNjLV9TRENyQk1RdnFKZGRQdw=='

    payload = json.dumps({
        "query": {
            "match": {
                "numeroProcesso": (numero_processo)
            }
        }
    })

    # Iterando sobre as URLs dos tribunais
    for tribunal, url in tribunais.items():
        headers = {
            'Authorization': f'APIKey {chavepublica}',
            'Content-Type': 'application/json'
        }

        response = requests.request("POST", url, headers=headers, data=payload)

        if response.status_code == 200:
            data = response.json()
            total_hits = data.get('hits', {}).get('total', {}).get('value', 0)  # Corrigindo aqui
            print(f'entrou no tribunal {tribunal}')

            if total_hits > 0:
                print(f"Dados encontrados no tribunal: {tribunal}")
                print(json.dumps(data, indent=4))
                break
        else:
            print(f"Não foi possível acessar o tribunal: {tribunal}")
